<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SPI Controller Class &mdash; covgDAQ 0.0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/plot_directive.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> covgDAQ
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="register.html">Register Class</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">covgDAQ</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>SPI Controller Class</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/SPIController.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spi-controller-class">
<h1>SPI Controller Class<a class="headerlink" href="#spi-controller-class" title="Permalink to this headline"></a></h1>
<p>Write Markdown here</p>
<span class="target" id="module-interfaces.interfaces"></span><dl class="py class">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">interfaces.interfaces.</span></span><span class="sig-name descname"><span class="pre">SPIController</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpga</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController" title="Permalink to this definition"></a></dt>
<dd><p>Class for controllers on the FPGA using SPI protocol.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>WB_SET_ADDRESS</strong><span class="classifier">int</span></dt><dd><p>Set address command for the Wishbone.</p>
</dd>
<dt><strong>WB_WRITE</strong><span class="classifier">int</span></dt><dd><p>Write command for the Wishbone.</p>
</dd>
<dt><strong>WB_READ</strong><span class="classifier">int</span></dt><dd><p>Read command for the Wishbone.</p>
</dd>
<dt><strong>WB_CLK_FREQ</strong><span class="classifier">int</span></dt><dd><p>Frequency of the clock the Wishbone runs on.</p>
</dd>
<dt><strong>fpga</strong><span class="classifier">FPGA</span></dt><dd><p>FPGA instance this controller uses to communicate.</p>
</dd>
<dt><strong>endpoints</strong><span class="classifier">dict</span></dt><dd><p>Endpoints on the FPGA this controller uses to communicate.</p>
</dd>
<dt><strong>master_config</strong><span class="classifier">int</span></dt><dd><p>Value of the CTRL register in the Wishbone.</p>
</dd>
<dt><strong>registers</strong><span class="classifier">dict</span></dt><dd><p>Name-Register pairs for the internal registers of the Wishbone.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 55%" />
<col style="width: 45%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>create_chips(cls, fpga, number_of_chips, endpoints=None, master_config=None)</strong></p></td>
<td><p>Class method. Instantiate a number of new chips.</p></td>
</tr>
<tr class="row-even"><td><p><strong>wb_send_cmd(command)</strong></p></td>
<td><p>Send a command to the Wishbone.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>wb_set_address(address)</strong></p></td>
<td><p>Set the address of the register we interact with in the Wishbone.</p></td>
</tr>
<tr class="row-even"><td><p><strong>wb_write(data)</strong></p></td>
<td><p>Write up to 30 bytes of data to the currently selected register.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>wb_read()</strong></p></td>
<td><p>Return the data stored in the currently selected register.</p></td>
</tr>
<tr class="row-even"><td><p><strong>wb_go()</strong></p></td>
<td><p>Initiate a SPI transmission.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>select_slave(slave_address)</strong></p></td>
<td><p>Select a slave device.</p></td>
</tr>
<tr class="row-even"><td><p><strong>set_divider(divider)</strong></p></td>
<td><p>Set the value of the Wishbone’s DIVIDER register.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>set_frequency(frequency)</strong></p></td>
<td><p>Set the frequency of SCL.</p></td>
</tr>
<tr class="row-even"><td><p><strong>write(data, register=0)</strong></p></td>
<td><p>Write data on the SCL and SDA lines.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>read(register=0)</strong></p></td>
<td><p>Return data from the selected data receive register.</p></td>
</tr>
<tr class="row-even"><td><p><strong>configure_master_bin(data)</strong></p></td>
<td><p>Set the value of the Wishbone’s CTRL register directly.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>configure_master(ASS=0, IE=0, LSB=0, Tx_NEG=0, Rx_NEG=0, CHAR_LEN=0)</strong></p></td>
<td><p>Set the Wishbone’s CTRL register using several arguments.</p></td>
</tr>
<tr class="row-even"><td><p><strong>get_master_configuration()</strong></p></td>
<td><p>Return the current configuration of CTRL register.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>reset_master()</strong></p></td>
<td><p>Reset the Wishbone Master and SPI Core.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.configure_master">
<span class="sig-name descname"><span class="pre">configure_master</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ASS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LSB</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tx_NEG</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rx_NEG</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CHAR_LEN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.configure_master"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.configure_master" title="Permalink to this definition"></a></dt>
<dd><p>Set the Wishbone’s CTRL register using several arguments.</p>
<p>ASS: Automatic Slave Select
IE: Set interrupt output active after a transfer is finished
LSB: Send LSB first
Tx_NEG: Change output signal on falling edge of SCLK
Rx_NEG: Latch input signal on falling edge of SCLK
CHAR_LEN: Number of bits transmitted per transfer (up to 64).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.configure_master_bin">
<span class="sig-name descname"><span class="pre">configure_master_bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.configure_master_bin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.configure_master_bin" title="Permalink to this definition"></a></dt>
<dd><p>Set the value of the Wishbone’s CTRL register directly.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.create_chips">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_chips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpga</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_chips</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.create_chips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.create_chips" title="Permalink to this definition"></a></dt>
<dd><p>Instantiate a number of new chips.</p>
<p>The number must be an integer greater than zero. The endpoints between
each instance will be incremented. If the endpoints argument is left
as None, then we will use copies of the endpoints_from_defines
dictionary for the endpoints for each instance, and update that
original dictionary when we increment the endpoints. This way, the
endpoints there are ready for another instantiation if needed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.get_master_configuration">
<span class="sig-name descname"><span class="pre">get_master_configuration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.get_master_configuration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.get_master_configuration" title="Permalink to this definition"></a></dt>
<dd><p>Return the current configuration of CTRL register.</p>
<p>Includes ASS, IO, LSB, Tx_NEG, Rx_NEG, CHAR_LEN.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">register</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.read" title="Permalink to this definition"></a></dt>
<dd><p>Return data from the selected data receive register.</p>
<p>Register should be 0, 1, 2, or 3.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.reset_master">
<span class="sig-name descname"><span class="pre">reset_master</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.reset_master"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.reset_master" title="Permalink to this definition"></a></dt>
<dd><p>Reset the Wishbone Master and SPI Core.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.select_slave">
<span class="sig-name descname"><span class="pre">select_slave</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slave_address</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.select_slave"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.select_slave" title="Permalink to this definition"></a></dt>
<dd><p>Selecting a slave device.</p>
<p>Set the correspoinding bit in the Slave Select register to 1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.set_divider">
<span class="sig-name descname"><span class="pre">set_divider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">divider</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.set_divider"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.set_divider" title="Permalink to this definition"></a></dt>
<dd><p>Set the value of the Wishbone’s DIVIDER register.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.set_fpga_mode">
<span class="sig-name descname"><span class="pre">set_fpga_mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.set_fpga_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.set_fpga_mode" title="Permalink to this definition"></a></dt>
<dd><p>Configure SPI controller to be host driven.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.set_frequency">
<span class="sig-name descname"><span class="pre">set_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.set_frequency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.set_frequency" title="Permalink to this definition"></a></dt>
<dd><p>Set the frequency of SPI SCLK.</p>
<p>Set the DIVIDER register of the Wishbone with the corresponding divider
for the target frequency. Frequency must be given in MHz.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.set_host_mode">
<span class="sig-name descname"><span class="pre">set_host_mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.set_host_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.set_host_mode" title="Permalink to this definition"></a></dt>
<dd><p>Configure SPI controller to be host driven.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.wb_go">
<span class="sig-name descname"><span class="pre">wb_go</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.wb_go"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.wb_go" title="Permalink to this definition"></a></dt>
<dd><p>Initiate a SPI transmission.</p>
<p>Initiated by setting the GO_BSY bit of the CTRL register to  1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.wb_is_ack">
<span class="sig-name descname"><span class="pre">wb_is_ack</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.wb_is_ack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.wb_is_ack" title="Permalink to this definition"></a></dt>
<dd><p>Check if the Wishbone sent back a write acknowledge.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.wb_read">
<span class="sig-name descname"><span class="pre">wb_read</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.wb_read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.wb_read" title="Permalink to this definition"></a></dt>
<dd><p>Return the data stored in the currently selected register.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.wb_send_cmd">
<span class="sig-name descname"><span class="pre">wb_send_cmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">command</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.wb_send_cmd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.wb_send_cmd" title="Permalink to this definition"></a></dt>
<dd><p>Send a command to the Wishbone.</p>
<p>Sent in 32 bits through the WbSignal_converter Verilog module tos
reformat to 34 bits.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.wb_set_address">
<span class="sig-name descname"><span class="pre">wb_set_address</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">address</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.wb_set_address"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.wb_set_address" title="Permalink to this definition"></a></dt>
<dd><p>Set the address of the register we interact with in the Wishbone.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.wb_write">
<span class="sig-name descname"><span class="pre">wb_write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.wb_write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.wb_write" title="Permalink to this definition"></a></dt>
<dd><p>Write up to 30 bytes of data to the currently selected register.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="interfaces.interfaces.SPIController.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">register</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interfaces/interfaces.html#SPIController.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#interfaces.interfaces.SPIController.write" title="Permalink to this definition"></a></dt>
<dd><p>Write data on the SPI lines.</p>
<p>Register should be either 0, 1, 2, or 3.</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, University of St. Thomas CpE/EE Instrumentation Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>